"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[509],{7509:function(e,l,a){a.r(l),a.d(l,{default:function(){return I}});var t=a(6252),u=a(3577),i=a(2262),o=a(6154);let n=localStorage.getItem("token");class s{getResidence(){let e,l=localStorage.getItem("token");try{const a=o.Z.get("https://api.plaimmobiliere.online/residence/getresidence",{headers:{Authorization:`${l}`}});e=a}catch(a){console.error(a)}return e}saveResidence(e){let l={type:null,msg:null,summary:null},a=[];a.push(e?.rue1,e?.rue2,e?.rue3,e?.rue4);const t=o.Z.post("https://api.plaimmobiliere.online/residence/add",{rname:e.name,rstreet:a},{headers:{Authorization:`${n}`}}).then((e=>(e.data.success?(l.type="success",l.msg="Résidence ajoutée avec succès",l.summary="Action Terminée"):(l.type="error",l.msg=e.data.msg,l.summary="ERREUR"),l))).catch((e=>(alert("Wrong user account "+e),l)));return t}async updateResidence(e){let l={type:null,msg:null,summary:null},a=[];a.push(e?.rue1,e?.rue2,e?.rue3,e?.rue4);try{const t=await o.Z.put(`https://api.plaimmobiliere.online/residence/update/${e.Id}`,{rname:e.name,rstreet:a},{headers:{Authorization:`${n}`}});return t.data.success?(l.type="success",l.msg="Résidence ajoutée avec succès",l.summary="Action Terminée"):(l.type="error",l.msg=t.data.msg,l.summary="ERREUR"),l}catch(t){console.error(t)}}async deleteResidence(e){let l={type:null,msg:null,summary:null};try{const a={Authorization:n},t=await o.Z["delete"](`https://api.plaimmobiliere.online/residence/delete/${e}`,{headers:a});return t.data.success?(l.type="success",l.msg="Résidence ajoutée avec succès",l.summary="Action Terminée"):(l.type="error",l.msg=t.data.msg,l.summary="ERREUR"),l}catch(a){console.error(a)}}}var r=a(9201);const d={class:"grid"},m={class:"col-12"},c={class:"card"},p={class:"my-2"},v={class:"field"},f=(0,t._)("label",{for:"name"},"Nom Residence",-1),b={class:"field"},y=(0,t._)("label",{for:"name"},"Nombre De rue",-1),h={key:0,class:"field"},w=(0,t._)("label",null," Nom Rue 1",-1),g={key:1,class:"field"},k=(0,t._)("label",null," Nom Rue 2",-1),R={key:2,class:"field"},_=(0,t._)("label",null," Nom Rue 3",-1),U={key:3,class:"field"},V=(0,t._)("label",null," Nom Rue 4",-1),W={class:"field"},C=(0,t._)("label",{for:"name"},"Nom Residence",-1),S={class:"field"},N=(0,t._)("label",{for:"name"},"Nombre De rue",-1),q={key:0,class:"field"},D=(0,t._)("label",null," Nom Rue 1",-1),x={key:1,class:"field"},P=(0,t._)("label",null," Nom Rue 2",-1),L={key:2,class:"field"},z=(0,t._)("label",null," Nom Rue 3",-1),H={key:3,class:"field"},M=(0,t._)("label",null," Nom Rue 4",-1),E={class:"flex align-items-center justify-content-center"},A=(0,t._)("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),T={key:0};var $={__name:"Residence",setup(e){let l=(0,i.iH)(""),a=(0,i.iH)(null);const o=(0,r.p)(),n=(0,i.iH)(null),$=(0,i.iH)(null),j=(0,i.iH)(!1),I=(0,i.iH)(!1),Z=(0,i.iH)(!1),B=(0,i.iH)({}),F=(0,i.iH)(!1),K=(0,i.iH)([{id:1,name:"1"},{id:2,name:"2"},{id:3,name:"3"},{id:4,name:"4"}]),O=(0,i.iH)(null);let Y=(0,i.iH)(null);const G=new s,J=async()=>{const e=await G.getResidence();$.value=e.data},Q=()=>{const e=new Event("save-successful");document.dispatchEvent(e),J()},X=()=>{B.value={},F.value=!1,j.value=!0},ee=()=>{I.value=!1,j.value=!1,B.value=null,O.value=null,F.value=!1},le=()=>{n.value.exportCSV()},ae=e=>{B.value={...e};let l=e.streets.filter((e=>null!=e));Y.value=l.length,B.value.rue1=l[0],B.value.rue2=l[1],B.value.rue3=l[2],B.value.rue4=l[3],O.value={id:l.length,name:`${l.length}`},I.value=!0},te=e=>{l=e.name,a=e.Id,Z.value=!0},ue=async()=>{F.value=!0;try{const e=await G.saveResidence(B.value);o.add({severity:e.type,summary:e.summary,detail:e.msg,life:3e3}),j.value=!1,B.value={},Q()}catch(e){console.log(e)}},ie=async()=>{const e=await G.deleteResidence(a);Z.value=!1,l="",a="",o.add({severity:e.type,summary:e.summary,detail:e.msg,life:3e3}),Q()},oe=async()=>{const e=await G.updateResidence(B.value);o.add({severity:e.type,summary:e.summary,detail:e.msg,life:3e3}),I.value=!1,Q()},ne=()=>{Y.value=O.value.id,1==Y.value&&(B.value.rue2=null,B.value.rue3=null,B.value.rue4=null),2==Y.value&&(B.value.rue2=null,B.value.rue3=null,B.value.rue4=null),3==Y.value&&(B.value.rue4=null)};return(0,t.bv)((()=>{J()})),(e,a)=>{const o=(0,t.up)("Toast"),s=(0,t.up)("Button"),r=(0,t.up)("Toolbar"),G=(0,t.up)("Column"),J=(0,t.up)("DataTable"),Q=(0,t.up)("InputText"),se=(0,t.up)("Dropdown"),re=(0,t.up)("Dialog");return(0,t.wg)(),(0,t.iD)("div",d,[(0,t._)("div",m,[(0,t._)("div",c,[(0,t.Wm)(o),(0,t.Wm)(r,{class:"mb-4"},{start:(0,t.w5)((()=>[(0,t._)("div",p,[(0,t.Wm)(s,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:X})])])),end:(0,t.w5)((()=>[(0,t.Wm)(s,{label:"Export",icon:"pi pi-upload",class:"p-button-help",onClick:a[0]||(a[0]=e=>le(e))})])),_:1}),(0,t.Wm)(J,{ref_key:"dt",ref:n,value:$.value,dataKey:"name",paginator:!0,rows:10,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Residences",responsiveLayout:"scroll"},{empty:(0,t.w5)((()=>[(0,t.Uk)(" Pas De residence . ")])),loading:(0,t.w5)((()=>[(0,t.Uk)(" Loading data. Please wait. ")])),default:(0,t.w5)((()=>[(0,t.Wm)(G,{field:"name",header:"Nom Residence",headerStyle:"width:5%; min-width:10rem;"},{body:(0,t.w5)((e=>[(0,t.Uk)((0,u.zw)(e.data.name),1)])),_:1}),(0,t.Wm)(G,{field:"streets",header:"Nb Rue",headerStyle:"width:5%; min-width:10rem;"},{body:(0,t.w5)((e=>[(0,t.Uk)((0,u.zw)(e.data.streets.filter((e=>null!=e)).length),1)])),_:1}),(0,t.Wm)(G,{field:"blocsCounter",header:"Nb Bloc",headerStyle:"width:5%; min-width:10rem;"},{body:(0,t.w5)((e=>[(0,t.Uk)((0,u.zw)(e.data.blocsCounter),1)])),_:1}),(0,t.Wm)(G,{field:"etageCounter",header:"Nb Etage",headerStyle:"width:5%; min-width:10rem;"},{body:(0,t.w5)((e=>[(0,t.Uk)((0,u.zw)(e.data.etageCounter),1)])),_:1}),(0,t.Wm)(G,{field:"LocalCounter",header:"Nb LC",headerStyle:"width:5%; min-width:10rem;"},{body:(0,t.w5)((e=>[(0,t.Uk)((0,u.zw)(e.data.LocalCounter),1)])),_:1}),(0,t.Wm)(G,{field:"appartementCounter",header:"Nb Appartement",headerStyle:"width:5%; min-width:10rem;"},{body:(0,t.w5)((e=>[(0,t.Uk)((0,u.zw)(e.data.appartementCounter),1)])),_:1}),(0,t.Wm)(G,{headerStyle:"min-width:10rem;"},{body:(0,t.w5)((e=>[(0,t.Wm)(s,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:l=>ae(e.data)},null,8,["onClick"]),(0,t.Wm)(s,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:l=>te(e.data)},null,8,["onClick"])])),_:1})])),_:1},8,["value"]),(0,t.Wm)(re,{visible:j.value,"onUpdate:visible":a[8]||(a[8]=e=>j.value=e),style:{width:"450px"},header:"Ajouter une residence",modal:!0,class:"p-fluid"},{footer:(0,t.w5)((()=>[(0,t.Wm)(s,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:ee}),(0,t.Wm)(s,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:ue,disabled:!B.value.name||!(0,i.SU)(Y)},null,8,["disabled"])])),default:(0,t.w5)((()=>[(0,t._)("div",v,[f,(0,t.Wm)(Q,{autocomplete:"off",id:"name",modelValue:B.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>B.value.name=e),modelModifiers:{trim:!0},required:"true",autofocus:"",class:(0,u.C_)({"p-invalid":F.value&&!B.value.name})},null,8,["modelValue","class"])]),(0,t._)("div",b,[y,(0,t.Wm)(se,{modelValue:O.value,"onUpdate:modelValue":a[2]||(a[2]=e=>O.value=e),options:K.value,optionLabel:"name",placeholder:"Select",onChange:a[3]||(a[3]=e=>ne())},null,8,["modelValue","options"])]),(0,i.SU)(Y)>0?((0,t.wg)(),(0,t.iD)("div",h,[w,(0,t.Wm)(Q,{autocomplete:"off",modelValue:B.value.rue1,"onUpdate:modelValue":a[4]||(a[4]=e=>B.value.rue1=e),modelModifiers:{trim:!0},required:"true"},null,8,["modelValue"])])):(0,t.kq)("",!0),(0,i.SU)(Y)>=2?((0,t.wg)(),(0,t.iD)("div",g,[k,(0,t.Wm)(Q,{autocomplete:"off",modelValue:B.value.rue2,"onUpdate:modelValue":a[5]||(a[5]=e=>B.value.rue2=e),modelModifiers:{trim:!0},required:"true"},null,8,["modelValue"])])):(0,t.kq)("",!0),(0,i.SU)(Y)>=3?((0,t.wg)(),(0,t.iD)("div",R,[_,(0,t.Wm)(Q,{autocomplete:"off",modelValue:B.value.rue3,"onUpdate:modelValue":a[6]||(a[6]=e=>B.value.rue3=e),modelModifiers:{trim:!0},required:"true"},null,8,["modelValue"])])):(0,t.kq)("",!0),(0,i.SU)(Y)>=4?((0,t.wg)(),(0,t.iD)("div",U,[V,(0,t.Wm)(Q,{autocomplete:"off",modelValue:B.value.rue4,"onUpdate:modelValue":a[7]||(a[7]=e=>B.value.rue4=e),modelModifiers:{trim:!0},required:"true"},null,8,["modelValue"])])):(0,t.kq)("",!0)])),_:1},8,["visible"]),(0,t.Wm)(re,{visible:I.value,"onUpdate:visible":a[17]||(a[17]=e=>I.value=e),style:{width:"450px"},header:"Modifier Residence",modal:!0,class:"p-fluid"},{footer:(0,t.w5)((()=>[(0,t.Wm)(s,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:ee}),(0,t.Wm)(s,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:a[16]||(a[16]=e=>oe())})])),default:(0,t.w5)((()=>[(0,t._)("div",W,[C,(0,t.Wm)(Q,{autocomplete:"off",id:"name",modelValue:B.value.name,"onUpdate:modelValue":a[9]||(a[9]=e=>B.value.name=e),modelModifiers:{trim:!0},required:"true",autofocus:"",class:(0,u.C_)({"p-invalid":F.value&&!B.value.name})},null,8,["modelValue","class"])]),(0,t._)("div",S,[N,(0,t.Wm)(se,{modelValue:O.value,"onUpdate:modelValue":a[10]||(a[10]=e=>O.value=e),options:K.value,optionLabel:"name",placeholder:"Select",onChange:a[11]||(a[11]=e=>ne())},null,8,["modelValue","options"])]),(0,i.SU)(Y)>0?((0,t.wg)(),(0,t.iD)("div",q,[D,(0,t.Wm)(Q,{autocomplete:"off",modelValue:B.value.rue1,"onUpdate:modelValue":a[12]||(a[12]=e=>B.value.rue1=e),modelModifiers:{trim:!0},required:"true"},null,8,["modelValue"])])):(0,t.kq)("",!0),(0,i.SU)(Y)>=2?((0,t.wg)(),(0,t.iD)("div",x,[P,(0,t.Wm)(Q,{autocomplete:"off",modelValue:B.value.rue2,"onUpdate:modelValue":a[13]||(a[13]=e=>B.value.rue2=e),modelModifiers:{trim:!0},required:"true"},null,8,["modelValue"])])):(0,t.kq)("",!0),(0,i.SU)(Y)>=3?((0,t.wg)(),(0,t.iD)("div",L,[z,(0,t.Wm)(Q,{autocomplete:"off",modelValue:B.value.rue3,"onUpdate:modelValue":a[14]||(a[14]=e=>B.value.rue3=e),modelModifiers:{trim:!0},required:"true"},null,8,["modelValue"])])):(0,t.kq)("",!0),(0,i.SU)(Y)>=4?((0,t.wg)(),(0,t.iD)("div",H,[M,(0,t.Wm)(Q,{autocomplete:"off",modelValue:B.value.rue4,"onUpdate:modelValue":a[15]||(a[15]=e=>B.value.rue4=e),modelModifiers:{trim:!0},required:"true"},null,8,["modelValue"])])):(0,t.kq)("",!0)])),_:1},8,["visible"]),(0,t.Wm)(re,{visible:Z.value,"onUpdate:visible":a[20]||(a[20]=e=>Z.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:(0,t.w5)((()=>[(0,t.Wm)(s,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:a[18]||(a[18]=e=>Z.value=!1)}),(0,t.Wm)(s,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:a[19]||(a[19]=e=>ie())})])),default:(0,t.w5)((()=>[(0,t._)("div",E,[A,B.value?((0,t.wg)(),(0,t.iD)("span",T,[(0,t.Uk)("etes vous sur de suprimer "),(0,t._)("b",null,(0,u.zw)((0,i.SU)(l)),1),(0,t.Uk)("? cette action va suprimer tous les blocs ainsi que vos etages et biens ")])):(0,t.kq)("",!0)])])),_:1},8,["visible"])])])])}}};const j=$;var I=j}}]);
//# sourceMappingURL=509.bcfa9f03.js.map