{"version":3,"file":"js/708.66eed0c7.js","mappings":"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","sources":["webpack://client/./src/service/servicebiens/EtageService.js","webpack://client/./src/views/biens/Etages.vue","webpack://client/./src/views/biens/Etages.vue?4f54"],"sourcesContent":["import axios from 'axios';\nlet tokenjwt = localStorage.getItem('token');\n\nexport default class EtageService {\n\n    getEtage(residenceId) {\n      \n        let respo;\n        let tokenjwt = localStorage.getItem('token');\n        try {\n          const response =  axios.get(`${process.env.VUE_APP_HOST_BACKEND}/etage/Getetages/${residenceId}`, {\n            headers: {\n              Authorization: `${tokenjwt}`,\n            },\n          });\n          respo=response;\n        } catch (error) {\n          console.error(error);\n        }\n       \n        return respo;\n\n  }\n  saveEtage(Residenceid,Etage,bloc) {  \n\n    let resp = {\n      type: null,\n      msg: null,\n      summary: null\n    }\n    let data={\n      idres: Residenceid,\n      idbloc: bloc,\n      numetage: Etage\n    }\n    const request = axios.post(`${process.env.VUE_APP_HOST_BACKEND}/etage/add`, data, {\n      headers: {\n        Authorization: `${tokenjwt}`,\n      },\n    })\n    .then(response => {\n      if (response.data.success){\n        resp.type = \"success\";\n        resp.msg = \"Résidence ajoutée avec succès\";\n        resp.summary = \"Action Terminée\";\n      }\n      else{\n        resp.type = \"error\";\n        resp.msg = response.data.msg;\n        resp.summary = \"ERREUR\";\n      }\n      return resp;\n    })\n    .catch(error => {\n      alert('Wrong user account ' +error )\n      return resp;\n    });\n  \n    return request;\n  }\n\n  async deleteEtage(EtageData,residenceId) {\n    let resp = {\n      type: null,\n      msg: null,\n      summary: null\n    }    \n    try {\n      const response = await axios.delete(`${process.env.VUE_APP_HOST_BACKEND}/etage/DeleteEtage/${residenceId}/${EtageData.blocid}/${EtageData.etageid}`,{\n        headers: {\n          Authorization: `${tokenjwt}`,\n        }\n      });\n      if (response.data.success){\n        resp.type = \"success\";\n        resp.msg = \"Etage supprimé avec succès\";\n        resp.summary = \"Action Terminée\";\n      }\n      else{\n        resp.type = \"error\";\n        resp.msg = response.data.msg;\n        resp.summary = \"ERREUR\";\n      }\n      return resp;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n}\n","<script setup>\r\nimport { ref, onMounted ,watchEffect} from 'vue';\r\nimport EtageService from '../../service/servicebiens/EtageService';\r\nimport { useToast } from 'primevue/usetoast';\r\n\r\nimport { useRoute } from 'vue-router';\r\nconst route = useRoute();  \r\nconst toast = useToast();\r\nconst dt = ref(null);\r\nconst EtagesData = ref(null);\r\nconst EtageaddDialog = ref(false);\r\nconst deleteEtageDialog = ref(false);\r\nconst Etageadd = ref({});\r\nconst submitted = ref(false);\r\nconst Etageservice = new EtageService();\r\nconst Residenceid = route.params.id;\r\n\r\nlet EtagedropdownValue  = ref(null);\r\nlet EtageValue  = ref(null);\r\n\r\nlet  Etagedatatoremove=ref([])\r\nlet  Etagenametoremove=ref(\"\")\r\n\r\nlet EtagedropdownValues = ref([]);\r\nlet EtagenumberdropdownValues = ref([]);\r\n\r\nconst refreshComponent = ()=>{\r\n    readResidence(Residenceid);\r\n}\r\nconst readResidence = async (id) => {\r\n    const response = await Etageservice.getEtage(id);\r\n\r\n    const blocsNames = response.data.blocsNames.map(bloc => ({\r\n        id: bloc.id,\r\n        name: `${bloc.name} `,\r\n        etageCounter: bloc.etageCount,\r\n    }));\r\n    EtagedropdownValues.value = blocsNames.map((bloc) => ({\r\n        id: bloc.id,\r\n        name: bloc.name,\r\n        etageCount: bloc.etageCounter,\r\n    }));\r\n\r\n    EtagesData.value = response.data.etageData;\r\n\r\n\r\n};\r\n\r\nconst getetagesfrombloc = (etage) => {\r\n    EtagenumberdropdownValues.value = [];\r\n    \r\n    const etageNumbers = [];\r\n    for (let i = 0; i <= 10; i++) {\r\n        if (i==0){\r\n            etageNumbers.push({ id: parseInt(i), name: \"RDC\" });\r\n        }\r\n        else{\r\n            if (etage.etageCount.indexOf(i) === -1) {\r\n                etageNumbers.push({ id: parseInt(i), name: i.toString() });\r\n            }\r\n        }\r\n\r\n    }\r\n    \r\n    EtagenumberdropdownValues.value = etageNumbers;\r\n};\r\n\r\n\r\n\r\n\r\n\r\nconst openNew = () => {\r\n    Etageadd.value = {};\r\n    EtagedropdownValue.value = null\r\n    EtageValue.value = null;\r\n    EtageaddDialog.value = true;\r\n};\r\nconst hideDialog = () => {\r\n    EtageaddDialog.value = false;\r\n\r\n};\r\nconst exportCSV = () => {\r\n    dt.value.exportCSV();\r\n};\r\n\r\nconst saveProduct = async () => {\r\n    const bloc=JSON.parse(JSON.stringify(EtagedropdownValue.value) ,true)\r\n    const number=JSON.parse(JSON.stringify(EtageValue.value) ,true)\r\n    const blocId =bloc.id\r\n    const numetage =number.id\r\n\r\n\r\n    submitted.value = true;\r\n    try {\r\n        const request = await Etageservice.saveEtage(Residenceid,numetage,blocId);\r\n        toast.add({ severity: request.type, summary: request.summary, detail: request.msg, life: 3000 });\r\n        EtageaddDialog.value = false;\r\n        Etageadd.value = {};\r\n        refreshComponent()\r\n    } catch (error) {\r\n        console.log(error);\r\n    }\r\n};\r\n\r\n\r\nconst confirmDeleteEtage =  (data) => {\r\n    Etagenametoremove = data.blocname + \" etage: \" + data.numetage;\r\n     Etagedatatoremove={\r\n        blocid:data.blocid,\r\n        etageid:data.etageid\r\n     }\r\n    deleteEtageDialog.value = true;\r\n};\r\nconst deleteEtage = async ()=>{\r\n    deleteEtageDialog.value = false;\r\n    const deleteresult= await Etageservice.deleteEtage(Etagedatatoremove,Residenceid)\r\n    Etagenametoremove = \"\";\r\n    Etagedatatoremove=\"\"\r\n    toast.add({ severity: deleteresult.type, summary: deleteresult.summary, detail: deleteresult.msg, life: 3000 });\r\n    refreshComponent()\r\n}\r\nwatchEffect(() => {\r\n    if (route.name == \"etages\") {\r\n        readResidence(route.params.id)\r\n    }  \r\n});\r\nonMounted( async () => {\r\n    readResidence(Residenceid)\r\n});\r\n\r\n</script>\r\n\r\n<template>\r\n    <div class=\"grid\">\r\n        <div class=\"col-12\">\r\n            <div class=\"card\">\r\n                <Toast />\r\n                <Toolbar class=\"mb-4\">\r\n                    <template v-slot:start>\r\n                        <div class=\"my-2\">\r\n                            <Button label=\"New\" icon=\"pi pi-plus\" class=\"p-button-success mr-2\" @click=\"openNew\" />\r\n                        </div>\r\n                    </template>\r\n                    \r\n                    <template v-slot:end>\r\n                        <Button label=\"Export\" icon=\"pi pi-upload\" class=\"p-button-help\" @click=\"exportCSV($event)\" />\r\n                    </template>\r\n                </Toolbar>\r\n                \r\n                <DataTable\r\n                    ref=\"dt\"\r\n                    :value=\"EtagesData\"\r\n                    dataKey=\"name\"\r\n                    :paginator=\"true\"\r\n                    :rows=\"10\"\r\n                    :sortOrder=\"-1\"\r\n                    sortField=\"blocname\"\r\n                    \r\n                    paginatorTemplate=\"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown\"\r\n                    :rowsPerPageOptions=\"[5, 10, 25]\"\r\n                    currentPageReportTemplate=\"Showing {first} to {last} of {totalRecords} Residences\"\r\n                    responsiveLayout=\"scroll\"\r\n                >    \r\n                <template #empty> Pas D'etages dans cette residence . </template>\r\n                <template #loading> Loading  data. Please wait. </template>\r\n\r\n                    <Column field=\"blocname\" header=\"Nom Bloc\"  :sortable=\"true\" headerStyle=\"width:5%; min-width:10rem;\">\r\n                        <template #body=\"slotProps\">\r\n                            {{ slotProps.data.blocname }}\r\n                        </template>\r\n                    </Column>\r\n                    <Column field=\"numetage\" header=\"Etage Num.\" sortable headerStyle=\"width:20%; min-width:10rem;\">\r\n                        <template #body=\"slotProps\">\r\n                            {{ slotProps.data.numetage ==0 ? \"RDC\" : slotProps.data.numetage }}\r\n                        </template>\r\n                    </Column>\r\n                    <Column field=\"localccounter\" header=\"Nb LC\" sortable headerStyle=\"width:20%; min-width:10rem;\">\r\n                        <template #body=\"slotProps\">\r\n                            {{ slotProps.data.localccounter }}\r\n                        </template>\r\n                    </Column>\r\n                    <Column field=\"appartementcounter\" header=\"Nb Appartement\" sortable  headerStyle=\"width:25%; min-width:10rem;\">\r\n                        <template #body=\"slotProps\">\r\n                            {{ slotProps.data.appartementcounter }}\r\n                        </template>\r\n                    </Column>\r\n                    <Column headerStyle=\"min-width:10rem;\">\r\n                        <template #body=\"slotProps\">\r\n                            <Button icon=\"pi pi-trash\" class=\"p-button-rounded p-button-warning mt-2\" @click=\"confirmDeleteEtage(slotProps.data)\" />\r\n                        </template>\r\n                    </Column>\r\n                </DataTable>\r\n               \r\n                <Dialog v-model:visible=\"EtageaddDialog\" :style=\"{ width: '450px' }\" header=\"Ajouter un etage\" :modal=\"true\" class=\"p-fluid\">\r\n                    <div class=\"field\">\r\n                        <label for=\"name\">Choisir Bloc</label>\r\n                        <Dropdown v-model=\"EtagedropdownValue\" :options=\"EtagedropdownValues\" optionLabel=\"name\" placeholder=\"Select\" @change=\"getetagesfrombloc(EtagedropdownValue)\"/>\r\n                    </div>\r\n                    <div class=\"field\">\r\n                        <label for=\"name\">Choisir Etage</label>\r\n                        <Dropdown v-model=\"EtageValue\" :options=\"EtagenumberdropdownValues\" optionLabel=\"name\" placeholder=\"Select\" />\r\n                    </div>\r\n\r\n                    <template #footer>\r\n                        <Button label=\"Cancel\" icon=\"pi pi-times\" class=\"p-button-text\" @click=\"hideDialog\" />\r\n                        <Button label=\"Save\" icon=\"pi pi-check\" class=\"p-button-text\" @click=\"saveProduct\" :disabled=\"!EtagedropdownValue || !EtageValue \"/>\r\n                    </template>\r\n                </Dialog>\r\n                \r\n                <Dialog v-model:visible=\"deleteEtageDialog\" :style=\"{ width: '450px' }\" header=\"Confirm\" :modal=\"true\">\r\n                    <div class=\"flex align-items-center justify-content-center\">\r\n                        <i class=\"pi pi-exclamation-triangle mr-3\" style=\"font-size: 2rem\" />\r\n                        <span v-if=\"Etageadd\">Etes vous sur de suprimer  <b>{{ Etagenametoremove }}</b> ? \r\n                            cela supprimera tous les appartements et locaux commerciaux de cet etage\r\n                        </span>\r\n                    </div>\r\n                    <template #footer>\r\n                        <Button label=\"No\" icon=\"pi pi-times\" class=\"p-button-text\" @click=\"deleteEtageDialog = false;Etagenametoremove=null\" />\r\n                        <Button label=\"Yes\" icon=\"pi pi-check\" class=\"p-button-text\" @click=\"deleteEtage\" />\r\n                    </template>\r\n                </Dialog>\r\n             \r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n","import script from \"./Etages.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Etages.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["tokenjwt","localStorage","getItem","EtageService","getEtage","residenceId","respo","response","axios","headers","Authorization","error","console","saveEtage","Residenceid","Etage","bloc","resp","type","msg","summary","data","idres","idbloc","numetage","request","then","success","catch","alert","async","EtageData","blocid","etageid","route","toast","dt","EtagesData","EtageaddDialog","deleteEtageDialog","Etageadd","submitted","Etageservice","params","id","EtagedropdownValue","EtageValue","Etagedatatoremove","Etagenametoremove","EtagedropdownValues","EtagenumberdropdownValues","refreshComponent","readResidence","blocsNames","map","name","etageCounter","etageCount","value","etageData","getetagesfrombloc","etage","etageNumbers","i","push","parseInt","indexOf","toString","openNew","hideDialog","exportCSV","saveProduct","JSON","parse","stringify","number","blocId","add","severity","detail","life","log","confirmDeleteEtage","blocname","deleteEtage","deleteresult","__exports__"],"sourceRoot":""}