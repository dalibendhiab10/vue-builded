"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[529],{8529:function(e,l,t){t.r(l),t.d(l,{default:function(){return ce}});var a=t(6252),i=t(3577),o=t(2262),n=t(6154),s=t(9201);const r={class:"grid",style:{"justify-content":"center"}},c={class:"card mb-0"},u={class:"flex justify-content-between mb-3"},d=(0,a._)("span",{class:"block text-500 font-medium mb-3"},"Appartement Libre",-1),m={class:"text-900 font-medium text-xl"},h=(0,a._)("div",{class:"flex align-items-center justify-content-center bg-red-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[(0,a._)("i",{class:"fas fa-house text-red-500 text-xl"})],-1),p={class:"card mb-0"},v={class:"flex justify-content-between mb-3"},g=(0,a._)("span",{class:"block text-500 font-medium mb-3"},"Lits Libres",-1),f={class:"text-900 font-medium text-xl"},b=(0,a._)("div",{class:"flex align-items-center justify-content-center bg-purple-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[(0,a._)("i",{class:"fas fa-procedures text-purple-500 text-xl"})],-1),_={class:"card mb-0"},w={class:"flex justify-content-between mb-3"},y=(0,a._)("span",{class:"block text-500 font-medium mb-3"},"Local Commercial Libre",-1),x={class:"text-900 font-medium text-xl"},k=(0,a._)("div",{class:"flex align-items-center justify-content-center bg-green-100 border-round",style:{width:"2.5rem",height:"2.5rem"}},[(0,a._)("i",{class:"fas fa-store text-green-500 text-xl"})],-1),L={class:"grid"},S={class:"col-12 xl:col-6"},U={class:"card"},C=(0,a._)("h5",{class:"mb-0"},"Contrats à Scanner",-1),D=(0,a._)("i",{class:"fas fa-external-link-alt fa-lg",style:{color:"#000000"}},null,-1),W={class:"col-12 xl:col-6"},H={class:"card"},z=(0,a._)("h5",{class:"mb-0"},"Prolongation de contrat",-1),A={class:"field"},B={key:0},F={class:"field"},N=(0,a._)("label",null,"choisir un locataire existant",-1),I={class:"field"},q=(0,a._)("label",null,"Choisir Bien",-1),$={key:0,class:"field"},j=(0,a._)("hr",null,null,-1),P=(0,a._)("h4",{style:{"text-align":"center"}},"A Propos",-1),E={class:"field"},V=(0,a._)("h5",null,"Locataire",-1),R={class:"field"},T=(0,a._)("h5",null,"Bien",-1),Z={class:"field"},O=(0,a._)("h5",null,"Debut De location",-1),G={class:"field"},Y=(0,a._)("h5",null,"Fin De location",-1),J=(0,a._)("hr",null,null,-1),K={class:"field"},M=(0,a._)("label",null,"Choisir Nouvelle Date de Fin de Location",-1),Q={key:0},X={class:"field"},ee=(0,a._)("h5",null,"Locataire",-1),le={class:"field"},te=(0,a._)("h5",null,"Bien",-1),ae={class:"field"},ie=(0,a._)("h5",null,"Debut De location",-1),oe={class:"field"},ne=(0,a._)("h5",null,"Nouvelle Date de Fin de Location",-1);var se={__name:"DashboardGestionLoc",setup(e){const l=(0,s.p)();let t=localStorage.getItem("token"),se=(0,o.iH)([]),re=(0,o.iH)(),ce=(0,o.iH)(),ue=(0,o.iH)(1),de=(0,o.iH)(!1),me=(0,o.iH)(!1),he=(0,o.iH)(!1),pe=(0,o.iH)(null),ve=(0,o.iH)([]),ge=(0,o.iH)(null),fe=(0,o.iH)(null),be=(0,o.iH)(null);const _e=(0,o.iH)([]),we=(0,o.iH)([{label:"Locataire",to:""},{label:"Confirmation",to:""}]),ye=(0,o.iH)([]);let xe=()=>{let e=document.getElementsByClassName("p-steps-item");if(ue.value>=3)ue.value=3,e[1].classList.add("p-highlight"),e[0].classList.remove("p-highlight");else for(let l=0;l<e.length;l++)l==ue.value?e[l].classList.add("p-highlight"):e[l].classList.remove("p-highlight");switch(ue.value++,ue.value){case 1:Le("Prolongation de contrat",!0,!1,!1);break;case 2:Le("Confirmation ",!1,!0,!1);break}},ke=()=>{ue.value--;let e=document.getElementsByClassName("p-steps-item");if(ue.value<=1)ue.value=1,e[0].classList.add("p-highlight"),e[1].classList.remove("p-highlight");else for(let l=0;l<e.length;l++)l+1===ue.value?e[l].classList.add("p-highlight"):e[l].classList.remove("p-highlight");switch(ue.value){case 1:Le("Prolongation de contrat",!0,!1,!1);break;case 2:Le("Confirmation ",!1,!0,!1);break}},Le=(e,l,t,a)=>{pe.value=e,de.value=l,me.value=t};const Se=()=>{n.Z.get("https://api.plaimmobiliere.online/statics/get/locations/current-month",{headers:{Authorization:t}}).then((e=>{ce.value=e.data})).catch((e=>{console.log(e)}))},Ue=()=>{n.Z.get("https://api.plaimmobiliere.online/payment/get/stegsonede",{headers:{Authorization:t}}).then((e=>{const l=e.data;if(Array.isArray(l.data)){ye.value=l.data;const e={};l.data.forEach((l=>{const{Idlocataire:t,fullname:a}=l;t in e||(e[t]={Idlocataire:t,fullname:a,location:l.locationid})}));const t=Object.values(e);se.value=t}else console.error("responseData is not an array:",l)})).catch((e=>{console.log(e)}))},Ce=()=>{he.value=!0,de.value=!0,me.value=!1,Ue(),ue.value=1,setTimeout((()=>{let e=document.getElementsByClassName("p-steps-item");e[0].classList.add("p-highlight"),pe.value="Prolongation de contrat"}),100)},De=()=>{he.value=!1,ue.value=1,de.value=!1,me.value=!1},We=e=>{setTimeout((()=>{e.query.trim().length?_e.value=se.value.filter((l=>l.code.toLowerCase().startsWith(e.query.toLowerCase()))):_e.value=[...se.value]}),50)},He=()=>{if(null!==fe.value){const e=ye.value.filter((e=>e.Idlocataire===fe.value.Idlocataire));let l=[],t="",a="";e.forEach((e=>{const i={year:"numeric",month:"long",day:"numeric",timeZone:"UTC"},o=new Date(e.from).toLocaleDateString("fr-FR",i),n=new Date(e.to).toLocaleDateString("fr-FR",i);a="0"==e.etagenum?"RDC":e.etagenum,e.locationid.startsWith("APPF")?t=`Res. ${e.resname} Etage ${a} Appartement ${e.numapp}`:e.locationid.startsWith("LOC")?t=`Res. ${e.resname} Etage ${a} Local Commercial ${e.IndexLocComm+1}`:e.locationid.startsWith("APPL")&&(t=`Res. ${e.resname} Etage ${a} Appartement ${e.numapp} CH ${e.IndexChambre+1} lit ${e.IndexLit+1}`),l.push({locataireid:e.Idlocataire,numapp:e.numapp,from:o,to:n,id:e.locationid,clientfullname:e.fullname,name:t,resname:e.resname,etagenum:e.etagenum,indexLit:e.IndexLit,indexChambre:e.IndexChambre||null,indexLocComm:e.IndexLocComm||null,resrue:e.resrue,cotion:e.cotion})})),ve.value=l}},ze=e=>{const l={year:"numeric",month:"long",day:"numeric"},t=new Date(e).toLocaleDateString("fr-FR",l);return t},Ae=()=>{let e={newdate:new Date(be.value)};n.Z.put(`https://api.plaimmobiliere.online/statics/update/prolongation/${ge.value.id}`,e,{headers:{Authorization:`${t}`}}).then((e=>{e.data.success?l.add({severity:"success",summary:"Succés",detail:"Prolongation avec succés",life:3e3}):l.add({severity:"error",summary:"Erreur",detail:"Erreur de prolongation",life:3e3}),De(),Se()})).catch((e=>{alert("Wrong user account "+e)}))};let Be=(0,o.iH)(),Fe=(0,o.iH)(0),Ne=(0,o.iH)(0),Ie=(0,o.iH)(0);return(0,a.bv)((()=>{Se(),n.Z.get("https://api.plaimmobiliere.online/statics/get/Dashboard",{headers:{Authorization:t}}).then((e=>{re.value=e.data.data})).catch((e=>{console.log(e)})),n.Z.get("https://api.plaimmobiliere.online/statics/get/reservation-free",{headers:{Authorization:t}}).then((e=>{Be.value=e.data.locationFind,Fe.value=e.data.counters.af,Ne.value=e.data.counters.lit,Ie.value=e.data.counters.loc})).catch((e=>{console.log(e)}))})),(e,l)=>{const t=(0,a.up)("Toast"),n=(0,a.up)("RouterLink"),s=(0,a.up)("router-link"),se=(0,a.up)("Toolbar"),ue=(0,a.up)("Column"),ye=(0,a.up)("DataTable"),Le=(0,a.up)("Steps"),Se=(0,a.up)("AutoComplete"),Ue=(0,a.up)("Dropdown"),Be=(0,a.up)("Calendar"),qe=(0,a.up)("FadeInOut"),$e=(0,a.up)("Button"),je=(0,a.up)("Dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(t),(0,a._)("div",r,[(0,a.Wm)(n,{to:"/Notrentlocation/AppF/",class:"col-12 lg:col-6 xl:col-3"},{default:(0,a.w5)((()=>[(0,a._)("div",c,[(0,a._)("div",u,[(0,a._)("div",null,[d,(0,a._)("div",m,(0,i.zw)((0,o.SU)(Fe)),1)]),h])])])),_:1}),(0,a.Wm)(n,{to:"/Notrentlocation/LitApp/",class:"col-12 lg:col-6 xl:col-3"},{default:(0,a.w5)((()=>[(0,a._)("div",p,[(0,a._)("div",v,[(0,a._)("div",null,[g,(0,a._)("div",f,(0,i.zw)((0,o.SU)(Ne)),1)]),b])])])),_:1}),(0,a.Wm)(n,{to:"/Notrentlocation/localcommercial/",class:"col-12 lg:col-6 xl:col-3"},{default:(0,a.w5)((()=>[(0,a._)("div",_,[(0,a._)("div",w,[(0,a._)("div",null,[y,(0,a._)("div",x,(0,i.zw)((0,o.SU)(Ie)),1)]),k])])])),_:1})]),(0,a._)("div",L,[(0,a._)("div",S,[(0,a._)("div",U,[(0,a.Wm)(se,{class:"mb-4"},{start:(0,a.w5)((()=>[C])),end:(0,a.w5)((()=>[(0,a.Wm)(s,{class:"p-link layout-topbar-button",to:"/Notrentlocation/LitApp/"},{default:(0,a.w5)((()=>[D])),_:1})])),_:1}),(0,a.Wm)(ye,{value:(0,o.SU)(re),rows:5,paginator:!0,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(ue,{field:"BienName",header:"Bien",style:{width:"35%"}},{body:(0,a.w5)((e=>[(0,a.Uk)((0,i.zw)(e.data.BienName),1)])),_:1}),(0,a.Wm)(ue,{field:"FullName",header:"Locataire",style:{width:"35%"}},{body:(0,a.w5)((e=>[(0,a.Uk)((0,i.zw)(e.data.FullName),1)])),_:1})])),_:1},8,["value"])])]),(0,a._)("div",W,[(0,a._)("div",H,[(0,a.Wm)(se,{class:"mb-4"},{start:(0,a.w5)((()=>[z])),end:(0,a.w5)((()=>[(0,a._)("i",{onClick:l[0]||(l[0]=e=>Ce()),class:"fas fa-external-link-alt fa-lg",style:{color:"#000000",cursor:"pointer"}})])),_:1}),(0,a.Wm)(ye,{value:(0,o.SU)(ce),rows:5,paginator:!0,responsiveLayout:"scroll"},{default:(0,a.w5)((()=>[(0,a.Wm)(ue,{field:"BienName",header:"Bien",style:{width:"35%"}},{body:(0,a.w5)((e=>[(0,a.Uk)((0,i.zw)(e.data.BienName),1)])),_:1}),(0,a.Wm)(ue,{field:"toDateString",header:"Fin de Location",style:{width:"35%"}},{body:(0,a.w5)((e=>[(0,a.Uk)((0,i.zw)(e.data.toDateString),1)])),_:1})])),_:1},8,["value"])])])]),(0,a.Wm)(je,{header:(0,o.SU)(pe),visible:(0,o.SU)(he),"onUpdate:visible":l[10]||(l[10]=e=>(0,o.dq)(he)?he.value=e:he=e),class:"p-fluid fixed-height",style:{width:"40vw",height:"50vw"},breakpoints:{"960px":"75vw","641px":"100vw"},modal:!0},{footer:(0,a.w5)((()=>[(0,o.SU)(de)?((0,a.wg)(),(0,a.j4)($e,{key:0,label:"Fermer",icon:"pi pi-times",class:"p-button-text",onClick:l[6]||(l[6]=e=>De())})):(0,a.kq)("",!0),(0,o.SU)(de)?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)($e,{key:1,label:"Precedant",icon:"pi pi-arrow-left",class:"p-button-text",onClick:l[7]||(l[7]=e=>(0,o.SU)(ke)())})),(0,o.SU)(de)?((0,a.wg)(),(0,a.j4)($e,{key:2,label:"suivant",icon:"pi pi-arrow-right",class:"p-button-text",onClick:l[8]||(l[8]=e=>(0,o.SU)(xe)())})):(0,a.kq)("",!0),(0,o.SU)(me)?((0,a.wg)(),(0,a.j4)($e,{key:3,label:"Confirmation",icon:"pi pi-check",class:"p-button-text",onClick:l[9]||(l[9]=e=>Ae())})):(0,a.kq)("",!0)])),default:(0,a.w5)((()=>[(0,a._)("div",A,[(0,a.Wm)(Le,{model:we.value,readonly:!0},null,8,["model"])]),(0,o.SU)(de)&&!(0,o.SU)(me)?((0,a.wg)(),(0,a.iD)("div",B,[(0,a._)("div",F,[N,(0,a.Wm)(Se,{placeholder:"Search",dropdown:!0,modelValue:(0,o.SU)(fe),"onUpdate:modelValue":l[1]||(l[1]=e=>(0,o.dq)(fe)?fe.value=e:fe=e),suggestions:_e.value,onComplete:l[2]||(l[2]=e=>We(e)),onChange:l[3]||(l[3]=e=>He()),field:"fullname"},null,8,["modelValue","suggestions"])]),(0,a._)("div",I,[q,(0,a.Wm)(Ue,{disabled:!(0,o.SU)(fe),modelValue:(0,o.SU)(ge),"onUpdate:modelValue":l[4]||(l[4]=e=>(0,o.dq)(ge)?ge.value=e:ge=e),options:(0,o.SU)(ve),optionLabel:"name",placeholder:"Select"},null,8,["disabled","modelValue","options"])]),(0,o.SU)(ge)?((0,a.wg)(),(0,a.iD)("div",$,[j,P,(0,a._)("div",E,[V,(0,a._)("label",null,(0,i.zw)((0,o.SU)(ge).clientfullname),1)]),(0,a._)("div",R,[T,(0,a._)("label",null,(0,i.zw)((0,o.SU)(ge).name),1)]),(0,a._)("div",Z,[O,(0,a._)("label",null,(0,i.zw)((0,o.SU)(ge).from),1)]),(0,a._)("div",G,[Y,(0,a._)("label",null,(0,i.zw)((0,o.SU)(ge).to),1)]),J])):(0,a.kq)("",!0),(0,a._)("div",K,[M,(0,a.Wm)(Be,{showIcon:!0,showButtonBar:!0,dateFormat:"dd/mm/yy",modelValue:(0,o.SU)(be),"onUpdate:modelValue":l[5]||(l[5]=e=>(0,o.dq)(be)?be.value=e:be=e)},null,8,["modelValue"])])])):(0,a.kq)("",!0),(0,a.Wm)(qe,{entry:"left",exit:"right",duration:100},{default:(0,a.w5)((()=>[(0,o.SU)(me)&&!(0,o.SU)(de)?((0,a.wg)(),(0,a.iD)("div",Q,[(0,a._)("div",X,[ee,(0,a._)("label",null,(0,i.zw)((0,o.SU)(ge).clientfullname),1)]),(0,a._)("div",le,[te,(0,a._)("label",null,(0,i.zw)((0,o.SU)(ge).name),1)]),(0,a._)("div",ae,[ie,(0,a._)("label",null,(0,i.zw)((0,o.SU)(ge).from),1)]),(0,a._)("div",oe,[ne,(0,a._)("label",null,(0,i.zw)(ze((0,o.SU)(be))),1)])])):(0,a.kq)("",!0)])),_:1})])),_:1},8,["header","visible"])],64)}}};const re=se;var ce=re}}]);
//# sourceMappingURL=529.ed33cf40.js.map