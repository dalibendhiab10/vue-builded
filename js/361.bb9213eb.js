"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[361],{3361:function(e,l,a){a.r(l),a.d(l,{default:function(){return te}});var i=a(6252),t=a(3577),o=a(2262),s=a(6154);let d=localStorage.getItem("token");class u{getLocalC(e){let l,a=localStorage.getItem("token");try{const i=s.Z.get(`https://api.plaimmobiliere.online/localc/view/${e}`,{headers:{Authorization:`${a}`}});l=i}catch(i){console.error(i)}return l}saveLocalC(e){let l={type:null,msg:null,summary:null},a={idres:e.Residenceid,idbloc:e.blocid,idetage:e.etagenumber,bisteg:e.isteg,bisonede:e.isonede,bigaz:e.igaz,surface:e.surface,prix:e.Prix,cotion:e.Cotion,rueid:e.rueid};console.log(a);const i=s.Z.post("https://api.plaimmobiliere.online/localc/add",a,{headers:{Authorization:`${d}`}}).then((e=>(e.data.success?(l.type="success",l.msg="Résidence ajoutée avec succès",l.summary="Action Terminée"):(l.type="error",l.msg=e.data.msg,l.summary="ERREUR"),l))).catch((e=>(alert("Wrong user account "+e),l)));return i}updateLc(e,l){let a={type:null,msg:null,summary:null},i={bisteg:e.isteg,bisonede:e.isonede,bigaz:e.igaz,surface:e.surface,newblocid:e.newblocid,newetageid:e.newetage,prix:e.Prix,cotion:e.Cotion};const t=s.Z.put(`https://api.plaimmobiliere.online/localC/update/${l}/${e.blocId}/${e.etageId}/${e.localcId}`,i,{headers:{Authorization:`${d}`}}).then((e=>(e.data.success?(a.type="success",a.msg="Résidence ajoutée avec succès",a.summary="Action Terminée"):(a.type="error",a.msg=e.data.msg,a.summary="ERREUR"),a))).catch((e=>(alert("Wrong user account "+e),a)));return t}deleteLocalc(e,l){let a={type:null,msg:null,summary:null};const i=s.Z["delete"](`https://api.plaimmobiliere.online/localC/delete/${l}/${e.blocId}/${e.etageid}/${e.localCid}`,{headers:{Authorization:`${d}`}}).then((e=>(e.data.success?(a.type="success",a.msg="Résidence ajoutée avec succès",a.summary="Action Terminée"):(a.type="error",a.msg=e.data.msg,a.summary="ERREUR"),a))).catch((e=>(alert("Wrong user account "+e),a)));return i}}var n=a(9201),c=a(2201);const m=e=>((0,i.dD)("data-v-2f955487"),e=e(),(0,i.Cn)(),e),r={class:"grid"},p={class:"col-12"},v={class:"card"},b={class:"my-2"},g={key:0,style:{color:"#ef4444"}},y={key:1,style:{color:"#22c55e"}},f={key:0,style:{color:"#ef4444"}},w={key:1,style:{color:"#22c55e"}},h={key:0,style:{color:"#ef4444"}},_={key:1,style:{color:"#22c55e"}},C={class:"mb-1 lg:col-4"},S=m((()=>(0,i._)("label",{for:"name",class:"mb-1"},"Nom Bloc",-1))),k={class:"mb-1 lg:col-4"},U=m((()=>(0,i._)("label",{for:"name",class:"mb-1"},"Etage Numero",-1))),W={class:"mb-1 lg:col-4"},x=m((()=>(0,i._)("label",{for:"name",class:"mb-1"},"Index Steg",-1))),N={class:"mb-1 lg:col-4"},I=m((()=>(0,i._)("label",{for:"name",class:"mb-1"},"Index Sonede",-1))),L={class:"mb-1 lg:col-4"},V=m((()=>(0,i._)("label",{for:"name",class:"mb-1"},"Index Gaz",-1))),z={class:"mb-1 lg:col-4"},P=m((()=>(0,i._)("label",{for:"name",class:"mb-1"},"Prix",-1))),D={class:"mb-1 lg:col-4"},R=m((()=>(0,i._)("label",{for:"name",class:"mb-1"},"Cotion",-1))),T={class:"field"},H=m((()=>(0,i._)("label",null,"Choisir Bloc",-1))),A={class:"field"},E=m((()=>(0,i._)("label",null,"Numero d'etage",-1))),j={class:"field"},$=m((()=>(0,i._)("label",null,"Numero d'etage",-1))),q={class:"field"},M=m((()=>(0,i._)("label",null,"ref Steg",-1))),B={class:"field"},Z=m((()=>(0,i._)("label",null,"ref Sonede",-1))),O={class:"field"},X=m((()=>(0,i._)("label",null,"ref Gaz",-1))),F={class:"field"},G=m((()=>(0,i._)("label",null,"Prix",-1))),K={class:"field"},Y=m((()=>(0,i._)("label",null,"Cotion",-1))),J={class:"flex align-items-center justify-content-center"},Q=m((()=>(0,i._)("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1))),ee={key:0};var le={__name:"Localc",setup(e){const l=new u,a=(0,o.iH)(null),s=(0,o.iH)(null),d=(0,c.yj)(),m=(0,n.p)(),le=d.params.id,ae=(0,o.iH)(null),ie=(0,o.iH)(!1),te=(0,o.iH)(!1),oe=(0,o.iH)(!1),se=(0,o.iH)({}),de=(0,o.iH)(!1);let ue=(0,o.iH)(""),ne=(0,o.iH)(""),ce=(0,o.iH)(""),me=(0,o.iH)(null),re=(0,o.iH)(null),pe=(0,o.iH)(null),ve=(0,o.iH)(null),be=(0,o.iH)(null),ge=(0,o.iH)(null);const ye=()=>{fe(le)},fe=async e=>{const i=await l.getLocalC(e),t=[],o=[];i.data.staticObject.forEach((e=>{const l=e.blocname,a=e.blocid;t.push({name:l,id:a})})),a.value=i.data.localcData,s.value=i.data.staticObject,re.value=t,i.data.staticObject[0].rue.map((e=>{let l={id:e.streetIndex,name:e.streetName};o.push(l)})),ge.value=o},we=()=>{ne.value="Ajouter un LocalCommercial",ce.value="Add",se.value={},de.value=!1,ie.value=!0,be.value=null,me.value=null,pe.value=null},he=()=>{ie.value=!1,de.value=!1,me.value=null,pe.value=null},_e=()=>{ae.value.exportCSV()};async function Ce(e){const l=s.value.find((l=>l.blocid==e.id)),a=l.etagesData;let i=[];a.forEach((e=>{let l={id:e.EtageId,name:"etage "+e.Numetage};i.push(l)})),ve.value=i}const Se=async()=>{de.value=!0;let e={Residenceid:le,...se.value,blocid:me.value.id,etagenumber:pe.value.id,rueid:be.value.id.toString()};const a=await l.saveLocalC(e);m.add({severity:a.type,summary:a.summary,detail:a.msg,life:3e3}),he(),ye()},ke=async e=>{let l={id:e.blocId,name:e.blocName};me.value=l,await Ce(l),ne.value="Modifier un Local Commercial",ce.value="edit",se.value=e,de.value=!1,ie.value=!0,pe.value={id:e.etageId,name:"etage "+e.etageNum}},Ue=e=>{oe.value=!0,se.value={...e}},We=async()=>{let e={...se.value,newblocid:me.value.id,newetage:pe.value.id};await l.updateLc(e,le).then((e=>{m.add({severity:e.type,summary:e.summary,detail:e.msg,life:3e3}),he(),ye()}))},xe=async e=>{ue.value=e,te.value=!0},Ne=async()=>{let e={blocId:ue.value.blocId,etageid:ue.value.etageId,localCid:ue.value.localcId};const a=await l.deleteLocalc(e,le);te.value=!1,ue.value="",m.add({severity:a.type,summary:a.summary,detail:a.msg,life:3e3}),ye()};return(0,i.m0)((()=>{"Localcomm"==d.name&&fe(d.params.id)})),(0,i.bv)((async()=>{fe(le)})),(e,l)=>{const s=(0,i.up)("Toast"),d=(0,i.up)("Button"),u=(0,i.up)("Toolbar"),n=(0,i.up)("Column"),c=(0,i.up)("DataTable"),m=(0,i.up)("InputText"),le=(0,i.up)("Sidebar"),de=(0,i.up)("Dropdown"),ue=(0,i.up)("Dialog");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i._)("div",p,[(0,i._)("div",v,[(0,i.Wm)(s),(0,i.Wm)(u,{class:"mb-4"},{start:(0,i.w5)((()=>[(0,i._)("div",b,[(0,i.Wm)(d,{label:"Ajouter",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:we})])])),end:(0,i.w5)((()=>[(0,i.Wm)(d,{label:"Exporter",icon:"pi pi-upload",class:"p-button-help",onClick:l[0]||(l[0]=e=>_e(e))})])),_:1}),(0,i.Wm)(c,{ref_key:"dt",ref:ae,value:a.value,dataKey:"name",paginator:!0,rows:10,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} Appartments",responsiveLayout:"scroll"},{empty:(0,i.w5)((()=>[(0,i.Uk)(" Pas De Local Commercial . ")])),default:(0,i.w5)((()=>[(0,i.Wm)(n,{field:"index",header:"Num LocCom.",headerStyle:"width:15%; min-width:10rem;"},{body:(0,i.w5)((e=>[e.data.isrent?((0,i.wg)(),(0,i.iD)("a",g,(0,t.zw)(e.data.index),1)):e.data.isrent?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("a",y,(0,t.zw)(e.data.index),1))])),_:1}),(0,i.Wm)(n,{field:"blocName",header:"Nom Bloc",headerStyle:"width:30%; min-width:10rem;"},{body:(0,i.w5)((e=>[(0,i.Uk)((0,t.zw)(e.data.blocName),1)])),_:1}),(0,i.Wm)(n,{field:"etageNum",header:"Num. etage",headerStyle:"width:30%; min-width:10rem;"},{body:(0,i.w5)((e=>[(0,i.Uk)((0,t.zw)(0==e.data.etageNum?"RDC":e.data.etageNum),1)])),_:1}),(0,i.Wm)(n,{field:"Prix",header:"est louée?",headerStyle:"width:30%; min-width:10rem;"},{body:(0,i.w5)((e=>[e.data.isrent?((0,i.wg)(),(0,i.iD)("a",f,(0,t.zw)(e.data.Prix)+" DT",1)):e.data.isrent?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("a",w,(0,t.zw)(e.data.Prix)+" DT",1))])),_:1}),(0,i.Wm)(n,{field:"Cotion",header:"est louée?",headerStyle:"width:30%; min-width:10rem;"},{body:(0,i.w5)((e=>[e.data.isrent?((0,i.wg)(),(0,i.iD)("a",h,(0,t.zw)(e.data.Cotion)+" DT",1)):e.data.isrent?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("a",_,(0,t.zw)(e.data.Cotion)+" DT",1))])),_:1}),(0,i.Wm)(n,{headerStyle:"width:20%; min-width:20rem;"},{body:(0,i.w5)((e=>[(0,i.Wm)(d,{icon:"fas fa-eye",class:"p-button-rounded p-button-secondary mr-2",onClick:l=>Ue(e.data)},null,8,["onClick"]),(0,i.Wm)(d,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:l=>ke(e.data)},null,8,["onClick"]),(0,i.Wm)(d,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:l=>xe(e.data)},null,8,["onClick"])])),_:1})])),_:1},8,["value"]),(0,i.Wm)(le,{visible:oe.value,"onUpdate:visible":l[1]||(l[1]=e=>oe.value=e),position:"right",class:"w-full md:w-20rem lg:w-30rem"},{default:(0,i.w5)((()=>[(0,i._)("h2",null,"LC Bloc "+(0,t.zw)(se.value.blocName)+" Etage "+(0,t.zw)(se.value.etageNum),1),(0,i._)("div",C,[S,(0,i.Wm)(m,{class:"input100",value:se.value.blocName,disabled:"disabled"},null,8,["value"])]),(0,i._)("div",k,[U,(0,i.Wm)(m,{class:"input100",value:se.value.etageNum,disabled:"disabled"},null,8,["value"])]),(0,i._)("div",W,[x,(0,i.Wm)(m,{class:"input100",value:se.value.isteg||"INEXISTANT",disabled:"disabled"},null,8,["value"])]),(0,i._)("div",N,[I,(0,i.Wm)(m,{class:"input100",value:se.value.isonede||"INEXISTANT",disabled:"disabled"},null,8,["value"])]),(0,i._)("div",L,[V,(0,i.Wm)(m,{class:"input100",value:se.value.igaz||"INEXISTANT",disabled:"disabled"},null,8,["value"])]),(0,i._)("div",z,[P,(0,i.Wm)(m,{class:"input100",value:se.value.Prix,disabled:"disabled"},null,8,["value"])]),(0,i._)("div",D,[R,(0,i.Wm)(m,{class:"input100",value:se.value.Cotion,disabled:"disabled"},null,8,["value"])])])),_:1},8,["visible"]),(0,i.Wm)(ue,{visible:ie.value,"onUpdate:visible":l[13]||(l[13]=e=>ie.value=e),style:{width:"450px"},header:(0,o.SU)(ne),modal:!0,class:"p-fluid"},{footer:(0,i.w5)((()=>[(0,i.Wm)(d,{label:"Fermer",icon:"pi pi-times",class:"p-button-text",onClick:he}),"Add"==(0,o.SU)(ce)?((0,i.wg)(),(0,i.j4)(d,{key:0,label:"Ajouter",icon:"pi pi-check",class:"p-button-text",onClick:l[11]||(l[11]=e=>Se()),disabled:!(0,o.SU)(me)||!(0,o.SU)(pe)||!se.value.isteg||!se.value.Cotion},null,8,["disabled"])):(0,i.kq)("",!0),"edit"==(0,o.SU)(ce)?((0,i.wg)(),(0,i.j4)(d,{key:1,label:"Modifier",icon:"pi pi-check",class:"p-button-text",onClick:l[12]||(l[12]=e=>We()),disabled:!(0,o.SU)(me)||!(0,o.SU)(pe)||!se.value.isteg||!se.value.Cotion},null,8,["disabled"])):(0,i.kq)("",!0)])),default:(0,i.w5)((()=>[(0,i._)("div",T,[H,(0,i.Wm)(de,{modelValue:(0,o.SU)(me),"onUpdate:modelValue":l[2]||(l[2]=e=>(0,o.dq)(me)?me.value=e:me=e),options:(0,o.SU)(re),optionLabel:"name",placeholder:"Select",onChange:l[3]||(l[3]=e=>Ce((0,o.SU)(me)))},null,8,["modelValue","options"])]),(0,i._)("div",A,[E,(0,i.Wm)(de,{modelValue:(0,o.SU)(pe),"onUpdate:modelValue":l[4]||(l[4]=e=>(0,o.dq)(pe)?pe.value=e:pe=e),options:(0,o.SU)(ve),optionLabel:"name",placeholder:"Select",disabled:!(0,o.SU)(me)},null,8,["modelValue","options","disabled"])]),(0,i._)("div",j,[$,(0,i.Wm)(de,{modelValue:(0,o.SU)(be),"onUpdate:modelValue":l[5]||(l[5]=e=>(0,o.dq)(be)?be.value=e:be=e),options:(0,o.SU)(ge),optionLabel:"name",placeholder:"Select",disabled:!(0,o.SU)(me)},null,8,["modelValue","options","disabled"])]),(0,i._)("div",q,[M,(0,i.Wm)(m,{autocomplete:"off",modelValue:se.value.isteg,"onUpdate:modelValue":l[6]||(l[6]=e=>se.value.isteg=e),modelModifiers:{trim:!0},disabled:!(0,o.SU)(me)||!(0,o.SU)(pe)},null,8,["modelValue","disabled"])]),(0,i._)("div",B,[Z,(0,i.Wm)(m,{autocomplete:"off",modelValue:se.value.isonede,"onUpdate:modelValue":l[7]||(l[7]=e=>se.value.isonede=e),modelModifiers:{trim:!0},disabled:!(0,o.SU)(me)||!(0,o.SU)(pe)},null,8,["modelValue","disabled"])]),(0,i._)("div",O,[X,(0,i.Wm)(m,{autocomplete:"off",modelValue:se.value.igaz,"onUpdate:modelValue":l[8]||(l[8]=e=>se.value.igaz=e),modelModifiers:{trim:!0},disabled:!(0,o.SU)(me)||!(0,o.SU)(pe)},null,8,["modelValue","disabled"])]),(0,i._)("div",F,[G,(0,i.Wm)(m,{modelValue:se.value.Prix,"onUpdate:modelValue":l[9]||(l[9]=e=>se.value.Prix=e),modelModifiers:{trim:!0},disabled:!(0,o.SU)(me)||!(0,o.SU)(pe)},null,8,["modelValue","disabled"])]),(0,i._)("div",K,[Y,(0,i.Wm)(m,{autocomplete:"off",modelValue:se.value.Cotion,"onUpdate:modelValue":l[10]||(l[10]=e=>se.value.Cotion=e),modelModifiers:{trim:!0},disabled:!(0,o.SU)(me)||!(0,o.SU)(pe)},null,8,["modelValue","disabled"])])])),_:1},8,["visible","header"]),(0,i.Wm)(ue,{visible:te.value,"onUpdate:visible":l[16]||(l[16]=e=>te.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:(0,i.w5)((()=>[(0,i.Wm)(d,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:l[14]||(l[14]=e=>te.value=!1)}),(0,i.Wm)(d,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:l[15]||(l[15]=e=>Ne())})])),default:(0,i.w5)((()=>[(0,i._)("div",J,[Q,se.value?((0,i.wg)(),(0,i.iD)("span",ee,"Etes vous sur de suprimer ce local commercial ?")):(0,i.kq)("",!0)])])),_:1},8,["visible"])])])])}}},ae=a(3744);const ie=(0,ae.Z)(le,[["__scopeId","data-v-2f955487"]]);var te=ie}}]);
//# sourceMappingURL=361.bb9213eb.js.map